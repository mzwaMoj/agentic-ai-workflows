# Production Environment Variables Configuration
# Copy this file to .env and update with your actual values

# ===============================================
# APPLICATION CONFIGURATION
# ===============================================
ENVIRONMENT=production
APP_NAME=text2sql-ai-analyst
APP_VERSION=1.0.0
DEBUG=false
LOG_LEVEL=INFO

# ===============================================
# AWS CONFIGURATION
# ===============================================
AWS_REGION=us-east-1
AWS_ACCOUNT_ID=123456789012

# ===============================================
# DATABASE CONFIGURATION
# ===============================================
# RDS SQL Server Primary
DB_HOST=text2sql-prod-db.cluster-xxxxxx.us-east-1.rds.amazonaws.com
DB_PORT=1433
DB_NAME=text2sql
DB_USER=admin
# Note: DB_PASSWORD should be retrieved from AWS Secrets Manager
# DB_PASSWORD will be loaded from: arn:aws:secretsmanager:us-east-1:123456789012:secret:text2sql-prod-db-credentials

# RDS Read Replica (for read-only operations)
DB_READ_HOST=text2sql-prod-db-replica.cluster-xxxxxx.us-east-1.rds.amazonaws.com
DB_READ_PORT=1433

# Connection Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ===============================================
# REDIS CONFIGURATION
# ===============================================
REDIS_HOST=text2sql-prod-redis.cluster.cache.amazonaws.com
REDIS_PORT=6379
REDIS_SSL=true
# REDIS_PASSWORD will be loaded from AWS Secrets Manager
# REDIS_AUTH_TOKEN_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789012:secret:text2sql-redis-auth

# Redis Connection Settings
REDIS_MAX_CONNECTIONS=100
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# ===============================================
# OPENSEARCH CONFIGURATION
# ===============================================
OPENSEARCH_HOST=search-text2sql-prod-search-xxxxxx.us-east-1.es.amazonaws.com
OPENSEARCH_PORT=443
OPENSEARCH_USE_SSL=true
OPENSEARCH_VERIFY_CERTS=true

# OpenSearch Indices
OPENSEARCH_TABLE_INDEX=table_embeddings
OPENSEARCH_QUERY_INDEX=query_patterns
OPENSEARCH_BATCH_SIZE=100

# ===============================================
# AMAZON BEDROCK CONFIGURATION
# ===============================================
BEDROCK_REGION=us-east-1

# Model Configuration
BEDROCK_TEXT2SQL_MODEL=anthropic.claude-3-sonnet-20240229-v1:0
BEDROCK_EMBEDDINGS_MODEL=amazon.titan-embed-text-v1
BEDROCK_OPTIMIZATION_MODEL=meta.llama2-70b-chat-v1
BEDROCK_ANALYSIS_MODEL=anthropic.claude-3-haiku-20240307-v1:0

# Bedrock Settings
BEDROCK_MAX_TOKENS=4096
BEDROCK_TEMPERATURE=0.1
BEDROCK_TOP_P=0.9
BEDROCK_RATE_LIMIT_PER_MINUTE=100

# ===============================================
# S3 CONFIGURATION
# ===============================================
S3_BUCKET_NAME=text2sql-prod-app-storage-abcd1234
S3_PROMPTS_PREFIX=prompts/
S3_LOGS_PREFIX=logs/
S3_UPLOADS_PREFIX=uploads/

# ===============================================
# AUTHENTICATION & SECURITY
# ===============================================
# AWS Cognito Configuration
COGNITO_USER_POOL_ID=us-east-1_xxxxxxxxx
COGNITO_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxxxxxx
COGNITO_IDENTITY_POOL_ID=us-east-1:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
COGNITO_REGION=us-east-1

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# Session Configuration
SESSION_SECRET_KEY=your-session-secret-key-change-this
SESSION_TIMEOUT_HOURS=8
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true

# ===============================================
# API CONFIGURATION
# ===============================================
API_PREFIX=/api/v1
API_TITLE=Text2SQL AI Analyst API
API_DESCRIPTION=Natural Language to SQL Conversion with AI Analytics
API_VERSION=1.0.0

# Rate Limiting
API_RATE_LIMIT_PER_MINUTE=60
API_RATE_LIMIT_PER_HOUR=1000
API_RATE_LIMIT_PER_DAY=10000

# Request Limits
MAX_REQUEST_SIZE_MB=10
MAX_UPLOAD_SIZE_MB=50
REQUEST_TIMEOUT_SECONDS=30

# ===============================================
# CORS CONFIGURATION
# ===============================================
CORS_ORIGINS=["https://your-frontend-domain.com", "https://d1234567890.cloudfront.net"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
CORS_ALLOW_HEADERS=["*"]

# ===============================================
# MONITORING & LOGGING
# ===============================================
# CloudWatch Configuration
CLOUDWATCH_LOG_GROUP=/ecs/text2sql-prod
CLOUDWATCH_LOG_STREAM=text2sql-application
CLOUDWATCH_METRICS_NAMESPACE=Text2SQL/Application

# X-Ray Tracing
XRAY_ENABLED=true
XRAY_TRACE_ID_HEADER=X-Amzn-Trace-Id

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/v1/health
HEALTH_CHECK_DETAILED_ENDPOINT=/api/v1/health/detailed

# ===============================================
# BACKGROUND TASKS & QUEUES
# ===============================================
# Celery Configuration (if using Celery for background tasks)
CELERY_BROKER_URL=redis://text2sql-prod-redis.cluster.cache.amazonaws.com:6379/0
CELERY_RESULT_BACKEND=redis://text2sql-prod-redis.cluster.cache.amazonaws.com:6379/0
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# Task Configuration
BACKGROUND_TASK_TIMEOUT=300
MAX_CONCURRENT_TASKS=10
TASK_RETRY_ATTEMPTS=3

# ===============================================
# CACHING CONFIGURATION
# ===============================================
# Query Result Caching
CACHE_QUERY_RESULTS=true
CACHE_QUERY_TTL_SECONDS=3600
CACHE_EMBEDDINGS_TTL_SECONDS=86400
CACHE_METADATA_TTL_SECONDS=3600

# Application Caching
CACHE_PROMPT_TEMPLATES=true
CACHE_PROMPT_TTL_SECONDS=3600
CACHE_USER_SESSIONS=true

# ===============================================
# FEATURE FLAGS
# ===============================================
FEATURE_A_B_TESTING=true
FEATURE_QUERY_OPTIMIZATION=true
FEATURE_RESULT_ANALYSIS=true
FEATURE_EMBEDDINGS_SEARCH=true
FEATURE_BATCH_PROCESSING=true
FEATURE_ADVANCED_ANALYTICS=true

# ===============================================
# PERFORMANCE & SCALING
# ===============================================
# Uvicorn Configuration
UVICORN_HOST=0.0.0.0
UVICORN_PORT=8000
UVICORN_WORKERS=4
UVICORN_WORKER_CLASS=uvicorn.workers.UvicornWorker
UVICORN_TIMEOUT_KEEP_ALIVE=65
UVICORN_TIMEOUT_GRACEFUL_SHUTDOWN=30

# Connection Limits
MAX_CONCURRENT_CONNECTIONS=1000
CONNECTION_TIMEOUT=30
KEEP_ALIVE_TIMEOUT=65

# ===============================================
# SECURITY HEADERS & POLICIES
# ===============================================
SECURITY_HSTS_ENABLED=true
SECURITY_CONTENT_TYPE_NOSNIFF=true
SECURITY_X_FRAME_OPTIONS=DENY
SECURITY_X_XSS_PROTECTION=true
SECURITY_REFERRER_POLICY=strict-origin-when-cross-origin

# Content Security Policy
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"
CSP_IMG_SRC="'self' data: https:"

# ===============================================
# BACKUP & DISASTER RECOVERY
# ===============================================
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=text2sql-prod-backups-abcd1234

# ===============================================
# INTEGRATION SETTINGS
# ===============================================
# External API Integrations (if any)
EXTERNAL_API_TIMEOUT=30
EXTERNAL_API_RETRY_ATTEMPTS=3
EXTERNAL_API_BACKOFF_FACTOR=2

# ===============================================
# DEVELOPMENT & TESTING
# ===============================================
# Set to false in production
ENABLE_API_DOCS=false
ENABLE_OPENAPI_JSON=false
ENABLE_REDOC=false

# Testing Configuration (for staging environment)
TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost/test_db
TEST_REDIS_URL=redis://localhost:6379/1
TEST_S3_BUCKET=text2sql-test-bucket

# ===============================================
# SECRETS MANAGER ARNS
# ===============================================
# These are the ARNs for secrets stored in AWS Secrets Manager
DB_CREDENTIALS_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789012:secret:text2sql-prod-db-credentials-AbCdEf
REDIS_AUTH_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789012:secret:text2sql-redis-auth-AbCdEf
APP_SECRETS_ARN=arn:aws:secretsmanager:us-east-1:123456789012:secret:text2sql-app-secrets-AbCdEf

# ===============================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ===============================================
# These can be overridden by ECS task definition environment variables
# or AWS Systems Manager Parameter Store values

# Override for specific deployments
DEPLOYMENT_ID=prod-v1.0.0
DEPLOYMENT_TIMESTAMP=2024-01-15T10:30:00Z
BUILD_NUMBER=123
GIT_COMMIT_SHA=abc123def456

# ===============================================
# NOTES
# ===============================================
# 1. Never commit actual secrets to version control
# 2. Use AWS Secrets Manager for sensitive values in production
# 3. Environment variables in ECS task definitions override these values
# 4. Some values are retrieved dynamically from AWS services
# 5. Update CORS_ORIGINS with your actual frontend domains
# 6. Adjust rate limits based on your expected traffic
# 7. Monitor and adjust connection pool sizes based on load testing
